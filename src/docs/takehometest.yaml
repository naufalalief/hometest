openapi: 3.0.0
info:
  title: Take Home Test Nutech API
  version: 1.0.0
  description: Dokumentasi API untuk Take Home Test Nutech
servers:
  - url: https://hometest-production-9643.up.railway.app/
  - url: http://localhost:3000
paths:
  /register:
    post:
      summary: API Registration Public (Tidak perlu Token untuk mengaksesnya)
      description: |
        Digunakan untuk melakukan registrasi User agar bisa Login kedalam aplikasi

        **Ketentuan:**
        1. Parameter request **email** harus terdapat validasi format email
        2. Parameter request **password** Length minimal 8 karakter
        3. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 1. Module Membership
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - first_name
                - last_name
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: user@nutech-integrasi.com
                first_name:
                  type: string
                  example: User
                last_name:
                  type: string
                  example: Nutech
                password:
                  type: string
                  minLength: 8
                  example: abcdef1234
      responses:
        "201":
          description: Registrasi berhasil
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 201
                  message:
                    type: string
                    example: Registrasi berhasil
                  data:
                    type: string
                    example: null
        "400":
          description: Data tidak lengkap atau format salah
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: number
                    example: 400
                  message:
                    type: string
                    example: Data tidak lengkap atau format salah
                  data:
                    type: string
                    example: null
        "409":
          description: Email sudah terdaftar
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: number
                    example: 409
                  message:
                    type: string
                    example: Email sudah terdaftar
                  data:
                    type: string
                    example: null
        "500":
          description: Terjadi kesalahan server
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: number
                    example: 500
                  message:
                    type: string
                    example: Terjadi kesalahan server
                  data:
                    type: string
                    example: null

  /login:
    post:
      summary: API Login Public (Tidak perlu Token untuk mengaksesnya)
      description: |
        Digunakan untuk melakukan login User agar bisa mendapatkan token akses kedalam aplikasi
        **Ketentuan:**
        1. Parameter request **email** harus terdapat validasi format email
        2. Parameter request **password** Length minimal 8 karakter
        3. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 1. Module Membership
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: user@nutech-integrasi.com
                password:
                  type: string
                  minLength: 8
                  example: abcdef1234
      responses:
        "200":
          description: Login berhasil
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 200
                  message:
                    type: string
                    example: Login berhasil
                  data:
                    type: object
                    properties:
                      token:
                        type: string
                        example: eyJhbGciOiJIUzI1NiIsInR5c
                      expires_in:
                        type: string
                        example: 3600
        "400":
          description: Data tidak lengkap atau format salah
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: number
                    example: 400
                  message:
                    type: string
                    example: Data tidak lengkap atau format salah
                  data:
                    type: string
                    example: null
        "401":
          description: Email atau password salah
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: number
                    example: 401
                  message:
                    type: string
                    example: Email atau password salah
                  data:
                    type: string
                    example: null
        "500":
          description: Terjadi kesalahan server
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: number
                    example: 500
                  message:
                    type: string
                    example: Terjadi kesalahan server
                  data:
                    type: string
                    example: null

  /profile:
    get:
      summary: API Profile Private (memerlukan Token untuk mengaksesnya)
      description: |
        Digunakan untuk mendapatkan informasi profile User

        **Ketentuan:**
        1. Service ini harus menggunakan Bearer Token JWT untuk mengaksesnya
        2. Tidak ada parameter email di query param url ataupun request body, parameter email diambil dari payload JWT yang didapatkan dari hasil login
        3. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 1. Module Membership
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Berhasil mendapatkan profile user
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 200
                  message:
                    type: string
                    example: Profile ditemukan
                  data:
                    type: object
                    properties:
                      email:
                        type: string
                        example: user@nutech-integrasi.com
                      first_name:
                        type: string
                        example: User
                      last_name:
                        type: string
                        example: Nutech
                      profile_image:
                        type: string
                        example: https://example.com/image.jpg
                      created_at:
                        type: string
                        format: date-time
                        example: 2024-01-01T00:00:00.000Z
        "401":
          description: Token tidak valid atau tidak ditemukan
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: number
                    example: 401
                  message:
                    type: string
                    example: Token tidak valid
                  data:
                    type: string
                    example: null
        "404":
          description: User tidak ditemukan
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: number
                    example: 404
                  message:
                    type: string
                    example: User tidak ditemukan
                  data:
                    type: string
                    example: null
  /profile/update:
    put:
      summary: API Update Profile Private (memerlukan Token untuk mengaksesnya)
      description: |
        Digunakan untuk mengupdate data profile User

        **Ketentuan :**
        1. Service ini harus menggunakan Bearer Token JWT untuk mengaksesnya
        2. Tidak ada parameter email di query param url ataupun request body, parameter email diambil dari payload JWT yang didapatkan dari hasil login
        3. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 1. Module Membership
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - first_name
                - last_name
              properties:
                first_name:
                  type: string
                  minLength: 5
                  example: User Edited
                last_name:
                  type: string
                  minLength: 5
                  example: Nutech Edited
      responses:
        "200":
          description: Request Successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 0
                  message:
                    type: string
                    example: Update Profile berhasil
                  data:
                    type: object
                    properties:
                      email:
                        type: string
                        example: user@nutech-integrasi.com
                      first_name:
                        type: string
                        example: User Edited
                      last_name:
                        type: string
                        example: Nutech Edited
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 108
                  message:
                    type: string
                    example: Token tidak tidak valid atau kadaluarsa
                  data:
                    type: string
                    example: null
  /profile/image:
    put:
      summary: API Upload Profile Image Private (memerlukan Token untuk mengaksesnya)
      description: |
        Digunakan untuk mengupdate / upload profile image User

        **Ketentuan :**
        1. Service ini harus menggunakan Bearer Token JWT untuk mengaksesnya
        2. Tidak ada parameter email di query param url ataupun request body, parameter email diambil dari payload JWT yang didapatkan dari hasil login
        3. Format image yang boleh di upload hanya jpeg dan png
        4. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 1. Module Membership
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        "200":
          description: Request Successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 0
                  message:
                    type: string
                    example: Update Profile Image berhasil
                  data:
                    type: object
                    properties:
                      email:
                        type: string
                        example: user@nutech-integrasi.com
                      first_name:
                        type: string
                        example: User Edited
                      last_name:
                        type: string
                        example: Nutech Edited
                      profile_image:
                        type: string
                        example: https://yoururlapi.com/profile-updated.jpeg
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 102
                  message:
                    type: string
                    example: Format Image tidak sesuai
                  data:
                    type: string
                    example: null
        "401":
          description: Unauthorized
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 108
                  message:
                    type: string
                    example: Token tidak tidak valid atau kadaluarsa
                  data:
                    type: string
                    example: null
  /banner:
    get:
      summary: API Banner Public (tidak memerlukan Token untuk mengaksesnya)
      description: |
        Digunakan untuk mendapatkan list banner

        **Ketentuan :**
        1. Buat data list banner sesuai dokumentasi Response dibawah, usahakan banner ini tidak di hardcode, melainkan ambil dari database
        2. Tidak perlu membuatkan module CRUD banner
        3. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 2. Module Information
      responses:
        "200":
          description: Berhasil mendapatkan list banner
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 0
                  message:
                    type: string
                    example: Sukses
                  data:
                    type: object
                    properties:
                      list:
                        type: array
                        items:
                          type: object
                          properties:
                            banner_name:
                              type: string
                              example: Banner 1
                            banner_image:
                              type: string
                              example: https://minio.nutech-integrasi.com/take-home-test/banner/Banner-1.png
                            description:
                              type: string
                              example: Lerem Ipsum Dolor sit amet
  /services:
    get:
      summary: API Services Private (memerlukan Token untuk mengaksesnya)
      description: |
        Digunakan untuk mendapatkan list Service/Layanan PPOB

        **Ketentuan :**
        1. Buat data list Service/Layanan sesuai dokumentasi Response dibawah, usahakan data list Service atau Layanan ini tidak di hardcode, melainkan ambil dari database
        2. Tidak perlu membuatkan module CRUD Service/Layanan
        3. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 2. Module Information
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Berhasil mendapatkan list service
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 200
                  message:
                    type: string
                    example: Sukses
                  data:
                    type: object
                    properties:
                      list:
                        type: array
                        items:
                          type: object
                          properties:
                            service_code:
                              type: string
                              example: PAJAK
                            service_name:
                              type: string
                              example: Pajak PBB
                            service_icon:
                              type: string
                              example: https://nutech-integrasi.app/dummy.jpg
        "401":
          description: Token tidak valid atau kadaluarsa
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 108
                  message:
                    type: string
                    example: Token tidak tidak valid atau kadaluarsa
                  data:
                    type: string
                    example: null
  /balance:
    get:
      summary: API Balance Private (memerlukan Token untuk mengaksesnya)
      description: |
        Digunakan untuk mendapatkan saldo user.

        **Ketentuan:**
        1. Service ini harus menggunakan Bearer Token JWT untuk mengaksesnya
        2. Tidak ada parameter email di query param url ataupun request body, parameter email diambil dari payload JWT yang didapatkan dari hasil login
        3. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 3. Module Balance
      security:
        - bearerAuth: []
      responses:
        "200":
          description: Berhasil mendapatkan saldo user
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 200
                  message:
                    type: string
                    example: Sukses
                  data:
                    type: object
                    properties:
                      balance:
                        type: integer
                        example: 2000000
        "401":
          description: Token tidak valid atau kadaluarsa
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 108
                  message:
                    type: string
                    example: Token tidak tidak valid atau kadaluarsa
                  data:
                    type: string
                    example: null

  /topup:
    post:
      summary: API Topup Private (memerlukan Token untuk mengaksesnya)
      description: |
        Digunakan untuk melakukan top up balance / saldo dari User

        **Ketentuan:**
        1. Service ini harus menggunakan Bearer Token JWT untuk mengaksesnya
        2. Tidak ada parameter email di query param atau input request body, parameter email diambil dari payload JWT yang didapatkan dari hasil login
        3. Setiap kali melakukan Top Up User otomatis bertambah
        4. Parameter amount hanya boleh angka saja dan tidak boleh lebih kecil dari 0
        5. Pada saat Top Up set transaction_type di database menjadi TOPUP
        6. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 3. Module Balance
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - top_up_amount
              properties:
                top_up_amount:
                  type: integer
                  example: 1000000
      responses:
        "200":
          description: Top Up Balance berhasil
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 200
                  message:
                    type: string
                    example: Top Up Balance berhasil
                  data:
                    type: object
                    properties:
                      balance:
                        type: integer
                        example: 2000000
        "400":
          description: Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 400
                  message:
                    type: string
                    example: Nominal top up tidak valid
                  data:
                    type: string
                    example: null
        "401":
          description: Token tidak valid atau kadaluarsa
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 108
                  message:
                    type: string
                    example: Token tidak tidak valid atau kadaluarsa
                  data:
                    type: string
                    example: null
  /transaction:
    post:
      summary: API Transaction Private (memerlukan Token untuk mengaksesnya)
      description: |
        Digunakan untuk melakukan transaksi dari services / layanan yang tersedia

        **Ketentuan :**
        1. Service ini harus menggunakan Bearer Token JWT untuk mengaksesnya
        2. Tidak ada parameter email di query param url ataupun request body, parameter email diambil dari payload JWT yang didapatkan dari hasil login
        3. Setiap kali melakukan Transaksi harus dipastikan balance / saldo mencukupi
        4. Pada saat Transaction set transaction_type di database menjadi PAYMENT
        5. Handling Response sesuai dokumentasi Response dibawah
        6. Response invoice_number untuk formatnya generik/bebas
      tags:
        - 3. Module Balance
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - service_code
              properties:
                service_code:
                  type: string
                  example: PULSA
      responses:
        "200":
          description: Transaksi Berhasil
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 200
                  message:
                    type: string
                    example: Transaksi berhasil
                  data:
                    type: object
                    properties:
                      invoice_number:
                        type: string
                        example: "a1b2c3d4e5f6g7h8"
        "400":
          description: Saldo tidak cukup / Bad Request
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 400
                  message:
                    type: string
                    example: Saldo tidak cukup
                  data:
                    type: string
                    example: null
        "401":
          description: Token tidak valid atau kadaluarsa
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 108
                  message:
                    type: string
                    example: Token tidak tidak valid atau kadaluarsa
                  data:
                    type: string
                    example: null
        "404":
          description: Service tidak ditemukan
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 404
                  message:
                    type: string
                    example: Service tidak ditemukan
                  data:
                    type: string
                    example: null

  /transaction/history:
    get:
      summary: API History Private (memerlukan Token untuk mengaksesnya)
      description: |
        Digunakan untuk mendapatkan informasi history transaksi

        **Ketentuan :**
        1. Service ini harus menggunakan Bearer Token JWT untuk mengaksesnya
        2. Tidak ada parameter email di query param url ataupun request body, parameter email diambil dari payload JWT yang didapatkan dari hasil login
        3. Offset dan limit query bersifat opsional, jika tidak diisi maka tampilkan semua data
        4. Data order dari yang paling baru berdasarkan transaction date (created_on)
        5. Handling Response sesuai dokumentasi Response dibawah
      tags:
        - 3. Module Balance
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: offset
          schema:
            type: integer
            default: 0
          description: Offset data
        - in: query
          name: limit
          schema:
            type: integer
            default: 10
          description: Limit data
      responses:
        "200":
          description: Get History Transaksi berhasil
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: number
                    example: 0
                  message:
                    type: string
                    example: Get History Berhasil
                  data:
                    type: object
                    properties:
                      offset:
                        type: integer
                        example: 0
                      limit:
                        type: integer
                        example: 3
                      records:
                        type: array
                        items:
                          type: object
                          properties:
                            invoice_number:
                              type: string
                              example: "INV17062023-001"
                            transaction_type:
                              type: string
                              example: "TOPUP"
                            description:
                              type: string
                              example: "Topup Balance"
                            total_amount:
                              type: integer
                              example: 100000
                            created_on:
                              type: string
                              format: date-time
                              example: "2023-06-17T10:19:10.000Z"
        "401":
          description: Token tidak valid atau kadaluarsa
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusCode:
                    type: number
                    example: 108
                  message:
                    type: string
                    example: Token tidak tidak valid atau kadaluarsa
                  data:
                    type: string
                    example: null

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
